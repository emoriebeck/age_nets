<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Community Structure | Interindividual Age Differences in Personality Structure</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Community Structure | Interindividual Age Differences in Personality Structure" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Community Structure | Interindividual Age Differences in Personality Structure" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Emorie D Beck" />
<meta name="author" content="David M Condon" />
<meta name="author" content="Joshua J Jackson" />


<meta name="date" content="2019-07-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pcors.html">
<link rel="next" href="procors.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>2</b> Background on the SAPA Project</a><ul>
<li class="chapter" data-level="2.1" data-path="background.html"><a href="background.html#packages"><i class="fa fa-check"></i><b>2.1</b> Packages</a></li>
<li class="chapter" data-level="2.2" data-path="background.html"><a href="background.html#methods"><i class="fa fa-check"></i><b>2.2</b> Methods</a><ul>
<li class="chapter" data-level="2.2.1" data-path="background.html"><a href="background.html#to-2010"><i class="fa fa-check"></i><b>2.2.1</b> 2006 to 2010</a></li>
<li class="chapter" data-level="2.2.2" data-path="background.html"><a href="background.html#to-2017"><i class="fa fa-check"></i><b>2.2.2</b> 2010 to 2017}</a></li>
<li class="chapter" data-level="2.2.3" data-path="background.html"><a href="background.html#merge-the-datasets-and-describe"><i class="fa fa-check"></i><b>2.2.3</b> Merge the datasets and Describe}</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workspace.html"><a href="workspace.html"><i class="fa fa-check"></i><b>3</b> Workspace</a><ul>
<li class="chapter" data-level="3.1" data-path="workspace.html"><a href="workspace.html#load-and-clean-data"><i class="fa fa-check"></i><b>3.1</b> Load and Clean Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fit-the-multi-trait-networks-mtnetworks.html"><a href="fit-the-multi-trait-networks-mtnetworks.html"><i class="fa fa-check"></i><b>4</b> Fit the Multi-Trait Networks {MTnetworks}</a><ul>
<li class="chapter" data-level="4.1" data-path="fit-the-multi-trait-networks-mtnetworks.html"><a href="fit-the-multi-trait-networks-mtnetworks.html#multi-trait-networks"><i class="fa fa-check"></i><b>4.1</b> Multi-Trait Networks</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="STnetworks.html"><a href="STnetworks.html"><i class="fa fa-check"></i><b>5</b> Fit the Single Trait Networks</a></li>
<li class="chapter" data-level="6" data-path="pcors.html"><a href="pcors.html"><i class="fa fa-check"></i><b>6</b> Age Differences in Coherence and Differentiation</a><ul>
<li class="chapter" data-level="6.1" data-path="pcors.html"><a href="pcors.html#Figure1"><i class="fa fa-check"></i><b>6.1</b> Multi-Trait Coherence and Differentiation</a></li>
<li class="chapter" data-level="6.2" data-path="pcors.html"><a href="pcors.html#Figure2"><i class="fa fa-check"></i><b>6.2</b> Single and Mutli-Trait Coherence</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="communities.html"><a href="communities.html"><i class="fa fa-check"></i><b>7</b> Community Structure</a><ul>
<li class="chapter" data-level="7.0.1" data-path="communities.html"><a href="communities.html#plots"><i class="fa fa-check"></i><b>7.0.1</b> Plots</a></li>
<li class="chapter" data-level="7.0.2" data-path="communities.html"><a href="communities.html#matching-across-communities"><i class="fa fa-check"></i><b>7.0.2</b> Matching Across Communities</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="procors.html"><a href="procors.html"><i class="fa fa-check"></i><b>8</b> Profile Correlations</a><ul>
<li class="chapter" data-level="8.1" data-path="procors.html"><a href="procors.html#Figure5"><i class="fa fa-check"></i><b>8.1</b> Profiles Correlation Plots (Figure 5)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interindividual Age Differences in Personality Structure</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="communities" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Community Structure</h1>
<p>Next, we calculate the communities in each network using the Spin Glass algorithm. Although there is no widely accepted definition of communities (Baroncelli, 2012), communities are generally considered to be nodes that are more connected to each other than to other nodes. For demonstrative purposes, we separately collapse across the 20s and 60s and run the networks. Then we calculate their community structure and compare them. ## Multi-Trait ### Run Communities</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">communities_fun &lt;-<span class="st">   </span><span class="cf">function</span>(g, cols){    
        g &lt;-<span class="st"> </span>igraph<span class="op">::</span><span class="kw">as.igraph</span>(g)
        <span class="kw">V</span>(g)<span class="op">$</span>label &lt;-<span class="st"> </span>cols
        g2 &lt;-<span class="st"> </span>g
        <span class="kw">E</span>(g2)<span class="op">$</span>weight &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">E</span>(g2)<span class="op">$</span>weight)
        lvc &lt;-<span class="st"> </span>igraph<span class="op">::</span><span class="kw">cluster_louvain</span>(g2)
        subgraphs &lt;-<span class="st"> </span><span class="kw">list</span>()
        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(lvc<span class="op">$</span>membership))){
          subgraphs[[i]] &lt;-<span class="st"> </span>igraph<span class="op">::</span><span class="kw">induced_subgraph</span>(g,
            <span class="dt">vids =</span> <span class="kw">which</span>(lvc<span class="op">$</span>membership <span class="op">==</span><span class="st"> </span>i),
            <span class="dt">impl =</span> <span class="st">&quot;copy_and_delete&quot;</span>)}
        results &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">graph =</span> g, 
                        <span class="dt">louvain =</span> lvc,
                        <span class="dt">subgraphs =</span> subgraphs)
        <span class="kw">return</span>(results)
}

membership_fun &lt;-<span class="st"> </span><span class="cf">function</span>(comm, cols){
  comm &lt;-<span class="st"> </span>comm<span class="op">$</span>louvain<span class="op">$</span>membership <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">setNames</span>(cols)
}

MT_net_nested &lt;-<span class="st"> </span>MT_net_nested <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">communities =</span> <span class="kw">map2</span>(net, cols, communities_fun),
         <span class="dt">membership =</span> <span class="kw">map2</span>(communities, cols, <span class="kw">possibly</span>(membership_fun, <span class="ot">NA_real_</span>)))

MT_net_nested_gr &lt;-<span class="st"> </span>MT_net_nested_gr <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">communities =</span> <span class="kw">map2</span>(net, cols, communities_fun),
         <span class="dt">membership =</span> <span class="kw">map2</span>(communities, cols, membership_fun))

communitiesall &lt;-<span class="st"> </span>(MT_net_nested <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span>))<span class="op">$</span>membership <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ldply</span>(.)
communities38below &lt;-<span class="st"> </span>(MT_net_nested <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">38</span>))<span class="op">$</span>membership <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ldply</span>(.)
communities39above &lt;-<span class="st"> </span>(MT_net_nested <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">39</span>))<span class="op">$</span>membership <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ldply</span>(.)</code></pre></div>
<div id="plots" class="section level3">
<h3><span class="header-section-number">7.0.1</span> Plots</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">communities20s &lt;-<span class="st"> </span>(MT_net_nested_gr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age_group <span class="op">==</span><span class="st"> </span><span class="dv">2</span>))<span class="op">$</span>communities[[<span class="dv">1</span>]]
communities60s &lt;-<span class="st"> </span>(MT_net_nested_gr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age_group <span class="op">==</span><span class="st"> </span><span class="dv">6</span>))<span class="op">$</span>communities[[<span class="dv">1</span>]]

b_color_fun &lt;-<span class="st"> </span><span class="cf">function</span>(c){
  <span class="kw">mapvalues</span>(c<span class="op">$</span>louvain<span class="op">$</span>membership, <span class="dt">from =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">max</span>(c<span class="op">$</span>louvain<span class="op">$</span>membership),<span class="dv">1</span>), 
            <span class="dt">to =</span> RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="kw">max</span>(c<span class="op">$</span>louvain<span class="op">$</span>membership),<span class="st">&quot;Set3&quot;</span>))
}

MT_net_nested_gr &lt;-<span class="st"> </span>MT_net_nested_gr <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bordercolors =</span> <span class="kw">map</span>(communities, b_color_fun), 
         <span class="dt">net =</span> <span class="kw">map2</span>(net, bordercolors, EDBqgraph_communities)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(age_group)

<span class="co"># pdf(filename = sprintf(&quot;%s/SAPA/photos/nets_20s_60s.bmp&quot;, data_path), width = 800, height = 400)</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plot</span>((MT_net_nested_gr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age_group <span class="op">==</span><span class="st"> </span><span class="dv">2</span>))<span class="op">$</span>net[[<span class="dv">1</span>]])
<span class="kw">title</span>(<span class="st">&quot;20s&quot;</span>)
<span class="kw">plot</span>((MT_net_nested_gr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span> <span class="op">&amp;</span><span class="st"> </span>age_group <span class="op">==</span><span class="st"> </span><span class="dv">6</span>))<span class="op">$</span>net[[<span class="dv">1</span>]])
<span class="kw">title</span>(<span class="st">&quot;60s&quot;</span>)</code></pre></div>
<div class="figure">
<img src="age_nets_files/figure-html/comm%20plots-1.png" alt="Figure 3. Item networks by age group. Nodes (circles) represent unique IPIP-50 items. Nodes colors are colored according to their putative Big Five scale membership, while node borders are colored according to their empirically derived community membership. Edges (lines between nodes) indicate partial correlations. Solid lines indicate positive relationships, while dashed lines indicate negative relationships." width="672" />
<p class="caption">
(#fig:comm plots)Figure 3. Item networks by age group. Nodes (circles) represent unique IPIP-50 items. Nodes colors are colored according to their putative Big Five scale membership, while node borders are colored according to their empirically derived community membership. Edges (lines between nodes) indicate partial correlations. Solid lines indicate positive relationships, while dashed lines indicate negative relationships.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dev.off()</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))
<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="cf">function</span>(x){ <span class="kw">plot</span>((MT_net_nested_gr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(inventory <span class="op">==</span><span class="st"> &quot;IPIP50&quot;</span>))<span class="op">$</span>net[[x]]); <span class="kw">title</span>(<span class="kw">sprintf</span>(<span class="st">&quot;%s0s&quot;</span>, x))})</code></pre></div>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL</code></pre>
<div class="figure">
<img src="age_nets_files/figure-html/age%20plots-1.png" alt="Supplementary Figure 3. Network Structure by Decade" width="672" />
<p class="caption">
(#fig:age plots)Supplementary Figure 3. Network Structure by Decade
</p>
</div>
</div>
<div id="matching-across-communities" class="section level3">
<h3><span class="header-section-number">7.0.2</span> Matching Across Communities</h3>
<p>The code below is a little incomprehensible, but in this instance there isnâ€™t really a better alternative.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">match_mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">50</span><span class="op">*</span><span class="dv">50</span>), <span class="dt">nrow =</span> <span class="dv">50</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){ <span class="co"># </span>
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){
    match &lt;-<span class="st"> </span>0L
    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){
      match &lt;-<span class="st"> </span><span class="kw">ifelse</span>(communitiesall[k,i] <span class="op">==</span><span class="st"> </span>communitiesall[k,j], match <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, match)
    }
    match_mat[i,j] &lt;-<span class="st"> </span>match
  }
}

match_mat38below &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">50</span><span class="op">*</span><span class="dv">50</span>), <span class="dt">nrow =</span> <span class="dv">50</span>)
match_mat39above &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">50</span><span class="op">*</span><span class="dv">50</span>), <span class="dt">nrow =</span> <span class="dv">50</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){
  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){
    match38below &lt;-<span class="st"> </span>0L
    match39above &lt;-<span class="st"> </span>0L
    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>){
      match38below &lt;-<span class="st"> </span><span class="kw">ifelse</span>(communities38below[k,i] <span class="op">==</span><span class="st"> </span>communities38below[k,j], match38below <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, match38below)
      match39above &lt;-<span class="st"> </span><span class="kw">ifelse</span>(communities39above[k,i] <span class="op">==</span><span class="st"> </span>communities39above[k,j], match39above <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, match39above)
    }
    match_mat38below[i,j] &lt;-<span class="st"> </span>match38below
    match_mat39above[i,j] &lt;-<span class="st"> </span>match39above
  }
}

community_plot_fun &lt;-<span class="st"> </span><span class="cf">function</span>(df, age, lim){
  <span class="kw">colnames</span>(df) &lt;-<span class="st"> </span>all_cols50; <span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>all_cols50
  df[<span class="kw">upper.tri</span>(df, <span class="dt">diag =</span> T)] &lt;-<span class="st"> </span><span class="ot">NA</span>
  <span class="kw">tbl_df</span>(df) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Edge1 =</span> <span class="kw">factor</span>(all_cols50, <span class="dt">levels =</span> all_cols50)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> Edge2, <span class="dt">value =</span> communities, <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Edge2 =</span> <span class="kw">factor</span>(Edge2, <span class="dt">levels =</span> all_cols50)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(communities)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Edge2, <span class="dt">y =</span> Edge1, <span class="dt">fill =</span> communities)) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">geom_raster</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">scale_fill_gradient</span>(
        <span class="dt">high =</span> <span class="st">&quot;orchid4&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,
        <span class="dt">limit =</span> <span class="kw">c</span>(<span class="dv">0</span>,lim), <span class="dt">name=</span><span class="st">&quot;Shared</span><span class="ch">\n</span><span class="st">Community</span><span class="ch">\n</span><span class="st">Sums&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, 
             <span class="dt">title =</span> <span class="kw">sprintf</span>(<span class="st">&quot;%s&quot;</span>, age)) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">angle =</span> <span class="dv">90</span>),
            <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),
            <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> .<span class="dv">5</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
}

communityall     &lt;-<span class="st"> </span><span class="kw">community_plot_fun</span>(match_mat, <span class="st">&quot;All&quot;</span>, <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>, .<span class="dv">5</span>))
community38below &lt;-<span class="st"> </span><span class="kw">community_plot_fun</span>(match_mat38below, <span class="st">&quot;38 &amp; below&quot;</span>, <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">3</span>)))
community39above &lt;-<span class="st"> </span><span class="kw">community_plot_fun</span>(match_mat39above, <span class="st">&quot;39 &amp; above&quot;</span>, <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,
        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">3</span>)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">community_plot &lt;-<span class="st">  </span><span class="kw">grid.arrange</span>(communityall, community38below, community39above, 
             <span class="dt">layout_matrix =</span> <span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),
                                   <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>)))</code></pre></div>
<div class="figure">
<img src="age_nets_files/figure-html/comm%20plot-1.png" alt="Figure 4. Frequency of shared community membership across items in (A) the full sample (B), participants 38 and below, (C) and participants 39 and above. Groups were split according to a median age split of all age groups for ease of comparing frequency, The diagonal of each plot indicates items within the same Big 5 scale, while off-diagonal elements are largely items of different scales. Darker colors indicate that the empirically derived community membership of two nodes was frequently shared across age groups, while lighter colors indicate that community membership was often not shared." width="672" />
<p class="caption">
(#fig:comm plot)Figure 4. Frequency of shared community membership across items in (A) the full sample (B), participants 38 and below, (C) and participants 39 and above. Groups were split according to a median age split of all age groups for ease of comparing frequency, The diagonal of each plot indicates items within the same Big 5 scale, while off-diagonal elements are largely items of different scales. Darker colors indicate that the empirically derived community membership of two nodes was frequently shared across age groups, while lighter colors indicate that community membership was often not shared.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ggsave(plot = community_plot, file = sprintf(&quot;%s/photos/shared_communities.png&quot;, data_path), </span>
<span class="co">#        width = 9, height = 6)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pcors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="procors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["age_nets.pdf", "age_nets.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
